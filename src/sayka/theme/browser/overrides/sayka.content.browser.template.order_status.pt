<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    lang="en"
    metal:use-macro="context/main_template/macros/master"
    i18n:domain="mingtak.billing">
<body>


<metal:content-core fill-slot="content-core">
<metal:content-core define-macro="content-core"
                    tal:define="toc context/table_of_contents|nothing;">
<style>
th,td{
    text-align:center;
    border-bottom: 1px solid #ccc;
    height: 45px;
    padding: 10px 0;
}
th{
    font-size: 18px;
}
td{
    font-size: 16px;
}
input[type=submit]{
    padding: 5px 12px;
}
.collapse{
     transition: height 0.6s;
}
</style>
        <div style='display: flex;justify-content:space-around'>
            <div style="width:15%">交易編號</div>
            <div style="width:15%">金額</div>
            <div style="width:25%">交易日期</div>
            <div style="width:15%">付款狀況</div>
            <div style='width:15%'>物流狀況</div>
            <div style='width:15%'></div>
        </div>
        <br/>        
        <tal:repeat define="order_data view/order_data" repeat="sort_tradeno view/sort_tradeno">
            <div style='display:flex;justify-content:space-between'>
                <div style='width:15%'>${sort_tradeno}</div>
                <div style='width:15%'>${python:order_data[sort_tradeno]['total_amount']}</div>
                <div style='width:25%'>${python:order_data[sort_tradeno]['TradeDate'][:10]}</div>
                <div style='width:15%'>${python:order_data[sort_tradeno]['status']}</div>
                <div tal:condition="python:order_data[sort_tradeno]['message']"  style='width:15%'>
                    ${python:order_data[sort_tradeno]['message']}
                </div>
                <div tal:condition="not:python:order_data[sort_tradeno]['message']"  style='width:15%'>
                 <?python
                    from plone import api
                    abs_url = api.portal.get().absolute_url()
                  ?>
                    <form id="allPay-Form" name="allPayForm" method="post" target="_self" 
                        action="${abs_url}/logistics_map" style="disply: none;">
                        <input type='hidden' name='MerchantTradeNo' value='${sort_tradeno}' />
                        <input type="submit" class="large" id="payment-btn" value="補齊物流資訊"/>
                    </form>
                </div>
                <div  style='width:15%'
                    data-toggle="collapse" data-target="#${sort_tradeno}" aria-expanded="false" 
                    aria-controls="${sort_tradeno}">
                    <span style='color:white;background:#97de95;'>更多資訊</span>
                </div>
            </div>
            <div class="collapse" id="${sort_tradeno}">
                <div style='display:flex;justify-content:space-around'>
                    <div style='width:50%'>交易明細</div>
                    <div style='width:20%'>送達時間</div>
                    <div style='width:30%'>取貨方式</div>
                </div>
                <div class="card card-body"  style='display:flex;justify-content:space-around'>
                    <div style='width:50%'>${python:order_data[sort_tradeno]['detail']}</div>
                    <div style='width:20%'>${python:order_data[sort_tradeno]['send_type']}</div>
                    <div style='width:30%'>${python:order_data[sort_tradeno]['status']}</div>  
                </div>
            </div>
        <hr>
        <br/>
        </tal:repeat>
</metal:content-core>
</metal:content-core>

</body>
</html>
